---
title: "Codlandingsproject"
author: "Kristin, Delphine, Reese"
date: "2023-02-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r upload-packages}
#install.packages("tidyverse")
library(tidyverse)
#install.packages("devtools")
library(devtools)
devtools::install_github("rstudio-education/dsbox", force = TRUE)
library(dsbox)
#install.packages("ggridges")
library(ggridges)
#install.packages("gganimate")
library(gganimate)
#install.packages("janitor")
library(janitor)
#install.packages("stringr")
library(stringr)
#install.packages("plotly")
library(plotly)
#install.packages("usmap")
library(usmap)
library(ggplot2)
install.packages("devtools")
devtools::install_github("UrbanInstitute/urbnmapr")

library(urbnmapr)
```

```{r}

us_maps <- us_map(region = "states")

states_sf <- get_urbn_map(map = "states", sf = TRUE)


ggplot(states_sf) +
  geom_sf()
```


```{r modify-column-names}
cod_landings <- read_csv("data/cod-landings.csv")
cod_landings <- cod_landings 
names(cod_landings)[names(cod_landings) == "NMFS Name"] <- "Common_Name"
names(cod_landings)[names(cod_landings) == "Metric Tons"] <- "Metric_Tons"
names(cod_landings)[names(cod_landings) == "Dollars"] <- "US_Dollars"
names(cod_landings)[names(cod_landings) == "Scientific Name"] <- "Scientific_Name"
names(cod_landings)[names(cod_landings) == "Collection"] <- "Fishing_Types"
names(cod_landings)[names(cod_landings) == "Tsn"] <- "Taxonomic_Serial_Number"
names(cod_landings)[names(cod_landings) == "Source"] <- "Fishing_Companies"
colnames(cod_landings)

```
```{r glimpe-dataset}
glimpse(cod_landings)
```

```{r change-wording-dataset}
cod_landings$Common_Name <- str_replace(cod_landings$Common_Name,"COD, PACIFIC", "Pacific_Cod")

cod_landings$Common_Name <- str_replace(cod_landings$Common_Name,"COD, ATLANTIC", "Atlantic_Cod")

cod_landings$Scientific_Name <- str_replace(cod_landings$Scientific_Name, "Gadus macrocephalus", "Gadus_macrocephalus")

cod_landings$Scientific_Name <- str_replace(cod_landings$Scientific_Name, "Gadus morhua", "Gadus_morhua")
cod_landings
```


Q1 - How do the weights of recorded recreational and commercial Cod landings of the Atlantic and Pacific compare to one another between the years 1950 and 2021?
Plan Q1 - Summarize the data through a ridgeline density plot of weight of landings, colored by “Fishing_Type” and faceted by “Common_Name”. Also include an animated plot of the same type to better show the fluctuation in landings every 10 years. 

```{r Q1-interactive-area-trial, fig.height=3, fig.width=6}
#plotly allows to get info on the gppah directly... still better moving
#exclude arctic and toothed cod?
#How to make it continuous like an actual area? these are discrete variables
# the years are not in order for the Pacific cod?
#how to see each year and change graduation for the pounds to make it easier?
#stacked bar chart better?
#add + customize labels
#Choose colors
# add cod moratorium in 1992?

Graph_01 <- cod_landings %>% 
   arrange(desc(Year)) %>%
  ggplot(mapping = aes(
         x = Year,
         y = Pounds,
         color = Common_Name)) +
    geom_area(alpha=0.5) +
    geom_line() +
    scale_x_continuous(breaks = seq(0, 100, 1))+
facet_wrap( ~ Common_Name)
# if want to choose color --> geom_area(fill="#69b3a2", alpha=0.5) +
  # geom_line(color="#69b3a2") 

Graph_01 <- ggplotly(Graph_01)
Graph_01

```


```{r total-pounds-column}
cod_landings_total= cod_landings %>%
  group_by(Year) %>%
   mutate(Total_Pounds = sum(Pounds)) %>%
  arrange(desc(Year)) 
```


```{r }
cod_landings_total %>%
  ggplot(mapping = aes(
         x = Year,
         y = Total_Pounds)) +
    geom_col()
```

